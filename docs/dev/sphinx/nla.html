<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Numerical Linear Algebra Primitives &mdash; libSkylark  documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="libSkylark  documentation" href="index.html" />
    <link rel="next" title="Machine Learning" href="ml.html" />
    <link rel="prev" title="Sketching Layer" href="sketching.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>libSkylark  documentation</span></a></h1>
        <h2 class="heading"><span>Numerical Linear Algebra Primitives</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="sketching.html">Sketching Layer</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="ml.html">Machine Learning</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="numerical-linear-algebra-primitives">
<h1>Numerical Linear Algebra Primitives<a class="headerlink" href="#numerical-linear-algebra-primitives" title="Permalink to this headline">¶</a></h1>
<p>This layer implements various numerical linear algebra primitives that are
accelerated using sketching.</p>
<div class="section" id="randomized-linear-least-squares">
<span id="simple-linearls"></span><h2>Randomized Linear Least-Squares<a class="headerlink" href="#randomized-linear-least-squares" title="Permalink to this headline">¶</a></h2>
<p>Based on the regression framework in the algorithmic layer, this functionality
provides sketching based linear least-squares regression routines. That is,
solve equations of the form:</p>
<div class="math">
<p><img src="_images/math/78fe473d4736c4b97480403b9527bf5a86a599d8.png" alt="\arg\min_X \|A * X - B\|_F"/></p>
</div><p>Note that the various algorithms can be executed directly using the regression API.
This layer just provides an easy-to-use functional interface that mirror Elemental&#8217;s
<a class="reference external" href="http://libelemental.org/documentation/0.83/lapack-like/solve.html">LeastSquares</a>
function, but uses sketching to accelerate the computation.</p>
<p>A running example is provided in <em>libskylark/examples/least_squares.cpp</em>.</p>
<div class="section" id="approximate-least-squares">
<h3>Approximate Least-squares<a class="headerlink" href="#approximate-least-squares" title="Permalink to this headline">¶</a></h3>
<p>Solve the problem approximately using a sktech-and-solve strategy.
Specifically, solve <img class="math" src="_images/math/478069cbaa494262b8583ab6a5d440d5e2fd27f7.png" alt="\arg\min_X \|S A X -  S B\|_F"/> where <img class="math" src="_images/math/e5f95fc1cde614179b82c3ec15f0bab4fd380591.png" alt="S \in R^{s\times n}"/>
is a Fast Johnson-Lindenstrauss Transform matrix
(<a class="reference external" href="http://www.cs.princeton.edu/~chazelle/pubs/FJLT-sicomp09.pdf">Ailon and Chazelle, 2009</a>).
It can be shown that if <img class="math" src="_images/math/6859317dd1b439cef34131bcd4bafee8393444e0.png" alt="s"/> is large enough (as a function of <img class="math" src="_images/math/19bc0073dde1bcd1a8e6a32b251e80cced668f04.png" alt="\epsilon"/>), then</p>
<div class="math">
<p><img src="_images/math/d35e5a4d7744e84d385ef3d8aa39fbfdb8616d7a.png" alt="\|A * X_{approx} - B\|_F \leq (1+\epsilon) \|A * X - B\|_F"/></p>
</div><p>where <img class="math" src="_images/math/904d5655ba09c07a2d1b26f026d239f8b45f4339.png" alt="X=\arg\min_X \|A * X - B\|_F"/> and <img class="math" src="_images/math/f9fdf75162dc7b0e9eeb2d02d88aa60e98ce39e4.png" alt="X_{approx}"/> is the approximate solution.
For the best known bounds see <a class="reference external" href="http://arxiv.org/abs/1204.0062">Boutsidis and Gittens (2013)</a>.</p>
<dl class="docutils">
<dt>The algorithm used is the one described in:</dt>
<dd><ul class="first last">
<li><div class="first line-block">
<div class="line">P. Drineas, M. W. Mahoney, S. Muthukrishnan, and T. Sarlos</div>
<div class="line"><a class="reference external" href="http://arxiv.org/abs/0710.1435">Faster Least Squares Approximation</a></div>
<div class="line">Numerische Mathematik, 117, 219-249 (2011).</div>
</div>
</li>
</ul>
</dd>
</dl>
<p>Unlike the algorithm described in the paper we allow the user to set the size of <img class="math" src="_images/math/6859317dd1b439cef34131bcd4bafee8393444e0.png" alt="s"/>.
There is also a default value, but it is much lower than the one suggested by that paper.</p>
<p>Note: it is assume that a <img class="math" src="_images/math/f09fbd65d15c149cd6c1f7ab74f697350039101b.png" alt="s \times n"/> matrix can fit in the memory of a single node
(<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> is the number of columns in <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/>).</p>
<hr class="docutils" />
<dl class="function">
<dt id="_CPP23ApproximateLeastSquaresN2El11OrientationERKN2El6MatrixI1TEERKN2El6MatrixI1TEERN2El6MatrixI1TEERN4base9context_tEi">
void <code class="descclassname"></code><code class="descname">ApproximateLeastSquares</code><span class="sig-paren">(</span>El::Orientation <em>orientation</em>, <em class="property">const</em> El::Matrix&lt;T&gt; &amp;<em>A</em>, <em class="property">const</em> El::Matrix&lt;T&gt; &amp;<em>B</em>, El::Matrix&lt;T&gt; &amp;<em>X</em>, base::context_t &amp;<em>context</em>, int <em>sketch_size</em> = -1<span class="sig-paren">)</span><a class="headerlink" href="#_CPP23ApproximateLeastSquaresN2El11OrientationERKN2El6MatrixI1TEERKN2El6MatrixI1TEERN2El6MatrixI1TEERN4base9context_tEi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPP23ApproximateLeastSquaresN2El11OrientationERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERN2El10DistMatrixI1TN2El4STAREN2El4STAREEERN4base9context_tEi">
void <code class="descclassname"></code><code class="descname">ApproximateLeastSquares</code><span class="sig-paren">(</span>El::Orientation <em>orientation</em>, <em class="property">const</em> El::DistMatrix&lt;T, El::VC, El::STAR&gt; &amp;<em>A</em>, <em class="property">const</em> El::DistMatrix&lt;T, El::VC, El::STAR&gt; &amp;<em>B</em>, El::DistMatrix&lt;T, El::STAR, El::STAR&gt; &amp;<em>X</em>, base::context_t &amp;<em>context</em>, int <em>sketch_size</em> = -1<span class="sig-paren">)</span><a class="headerlink" href="#_CPP23ApproximateLeastSquaresN2El11OrientationERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERN2El10DistMatrixI1TN2El4STAREN2El4STAREEERN4base9context_tEi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>If <cite>orientation</cite> is set to <code class="docutils literal"><span class="pre">NORMAL</span></code>, then approximate <img class="math" src="_images/math/485e12a6c8da2e147f54242e795622ddb82bed52.png" alt="\arg\min_X \|A * X - B\|_F"/>, otherwise
<cite>orientation</cite> must be equal to <code class="docutils literal"><span class="pre">ADJOINT</span></code> and <img class="math" src="_images/math/8447326c551223e636d142d55db5e22ee5cf6496.png" alt="\arg\min_X \|A^H * X - B\|_F"/> is approximated.</p>
<p>sketch_size controls the number of rows in <img class="math" src="_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/>.</p>
<hr class="docutils" />
<p>A flavor of usage is given in the code snippet below.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;elemental.hpp&gt;</span>
<span class="cp">#include &lt;skylark.hpp&gt;</span>
<span class="p">...</span>
<span class="c1">// Setup regression problem with coefficient matrix A and target matrix B</span>
<span class="p">...</span>

<span class="n">skybase</span><span class="o">::</span><span class="kt">context_t</span> <span class="n">context</span><span class="p">(</span><span class="mi">23234</span><span class="p">);</span>

<span class="c1">// Solve the Least Squres problem of minimizing || AX - B||_2 over X</span>
<span class="n">skylark</span><span class="o">::</span><span class="n">nla</span><span class="o">::</span><span class="n">ApproximateLeastSquares</span><span class="p">(</span><span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">context</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="faster-least-squares">
<h3>Faster Least-squares<a class="headerlink" href="#faster-least-squares" title="Permalink to this headline">¶</a></h3>
<p>Solve the linear least-squares problem using a sketching-accelerated algorithm.
This algorithm uses sketching to build a preconditioner, and then uses the preconditioner
in an iterative method. While technically the solution found is approximate (due to the use
of an iterative method), the threshold is set close to machine precision
so the solution&#8217;s accuracy is close to the full accuracy possible on a machine.</p>
<dl class="docutils">
<dt>The algorithm used is the one described in:</dt>
<dd><ul class="first last">
<li><div class="first line-block">
<div class="line">H. Avron, P. Maymounkov, and S. Toledo</div>
<div class="line"><a class="reference external" href="http://epubs.siam.org/doi/abs/10.1137/090767911">Blendenpik: Supercharging LAPACK&#8217;s Least-Squares Solver</a></div>
<div class="line">SIAM Journal on Scientific Computing 32(3), 1217-1236, 2010</div>
</div>
</li>
</ul>
</dd>
</dl>
<p>Note: it is assume that a <img class="math" src="_images/math/148b0dbe36192f1c7d3392d5d890527074ab49c2.png" alt="4 n^2"/> matrix can fit in the memory of a single node
(<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> is the number of columns in <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/>).</p>
<hr class="docutils" />
<dl class="function">
<dt id="_CPP16FastLeastSquaresN2El11OrientationERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERN2El10DistMatrixI1TN2El4STAREN2El4STAREEERN4base9context_tE">
void <code class="descclassname"></code><code class="descname">FastLeastSquares</code><span class="sig-paren">(</span>El::Orientation <em>orientation</em>, <em class="property">const</em> El::DistMatrix&lt;T, El::VC, El::STAR&gt; &amp;<em>A</em>, <em class="property">const</em> El::DistMatrix&lt;T, El::VC, El::STAR&gt; &amp;<em>B</em>, El::DistMatrix&lt;T, El::STAR, El::STAR&gt; &amp;<em>X</em>, base::context_t &amp;<em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPP16FastLeastSquaresN2El11OrientationERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERKN2El10DistMatrixI1TN2El2VCEN2El4STAREEERN2El10DistMatrixI1TN2El4STAREN2El4STAREEERN4base9context_tE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>If <cite>orientation</cite> is set to <code class="docutils literal"><span class="pre">NORMAL</span></code>, then approximate <img class="math" src="_images/math/485e12a6c8da2e147f54242e795622ddb82bed52.png" alt="\arg\min_X \|A * X - B\|_F"/>, otherwise
<cite>orientation</cite> must be equal to <code class="docutils literal"><span class="pre">ADJOINT</span></code> and <img class="math" src="_images/math/8447326c551223e636d142d55db5e22ee5cf6496.png" alt="\arg\min_X \|A^H * X - B\|_F"/> is approximated.</p>
<hr class="docutils" />
<p>A flavor of usage is given in the code snippet below.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;elemental.hpp&gt;</span>
<span class="cp">#include &lt;skylark.hpp&gt;</span>
<span class="p">...</span>
<span class="c1">// Setup regression problem with coefficient matrix A and target matrix B</span>
<span class="p">...</span>

<span class="n">skybase</span><span class="o">::</span><span class="kt">context_t</span> <span class="n">context</span><span class="p">(</span><span class="mi">23234</span><span class="p">);</span>

<span class="c1">// Solve the Least Squres problem of minimizing || AX - B||_2 over X</span>
<span class="n">skylark</span><span class="o">::</span><span class="n">nla</span><span class="o">::</span><span class="n">FasterLeastSquares</span><span class="p">(</span><span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">context</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="randomized-singular-value-decomposition">
<h2>Randomized Singular Value Decomposition<a class="headerlink" href="#randomized-singular-value-decomposition" title="Permalink to this headline">¶</a></h2>
<p>The randomized SVD functionality provides a distributed implementation of algorithms described in</p>
<blockquote>
<div><blockquote>
<div><ul>
<li><div class="first line-block">
<div class="line">Halko, N. and Martinsson, P.G, and Tropp J.</div>
<div class="line"><a class="reference external" href="http://arxiv.org/abs/0909.4061">Finding structure with randomness: Probabilistic algorithms for constructing approximate matrix decompositions</a></div>
<div class="line">SIAM Rev., Survey and Review section, Vol. 53, num. 2, pp. 217-288, 2011</div>
</div>
</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>The prototypical algorithm involves the following steps, given a matrix <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/></dt>
<dd><ul class="first last simple">
<li>Compute an approximate orthonormal basis for the range of <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/>, as specified by the columns of an orthonormal matrix <img class="math" src="_images/math/7b1816c51f7d31275cd3ad400208fb7b3ce136a0.png" alt="Q"/>.</li>
<li>Use <img class="math" src="_images/math/7b1816c51f7d31275cd3ad400208fb7b3ce136a0.png" alt="Q"/> to compute a standard factorization of <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/>.</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>The first step is accelerated using sketching.</p>
<div class="section" id="approximate-svd">
<h3>Approximate SVD<a class="headerlink" href="#approximate-svd" title="Permalink to this headline">¶</a></h3>
<p>Compute an approximate SVD in the sense that <img class="math" src="_images/math/893632b6baf3aac6618bbe86b297f72fd866b218.png" alt="A \approx U S V^T"/>. The inner
dimension <img class="math" src="_images/math/e9203da50e1059455123460d4e716c9c7f440cc3.png" alt="k"/> is specified by the user as parameter.</p>
<dl class="function">
<dt id="_CPP14ApproximateSVDR9InputTypeR5UTypeR5STypeR5VTypeiRN4base9context_tE24approximate_svd_params_t">
void <code class="descclassname"></code><code class="descname">ApproximateSVD</code><span class="sig-paren">(</span>InputType &amp;<em>A</em>, UType &amp;<em>U</em>, SType &amp;<em>S</em>, VType &amp;<em>V</em>, int <em>rank</em>, base::context_t &amp;<em>context</em>, approximate_svd_params_t <em>params</em> = approximate_svd_params_t()<span class="sig-paren">)</span><a class="headerlink" href="#_CPP14ApproximateSVDR9InputTypeR5UTypeR5STypeR5VTypeiRN4base9context_tE24approximate_svd_params_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>For a running example, please see <em>libskylark/examples/svd.cpp</em>. This example provides a
complete driver for running this functionality from command-line.</p>
</div>
</div>
<div class="section" id="condition-number-estimation">
<h2>Condition Number Estimation<a class="headerlink" href="#condition-number-estimation" title="Permalink to this headline">¶</a></h2>
<p>Estimate the condition number of a matrix using a low-memory iterative method. Only
the ability to multiply the matrix by a vector, and its transpose by a vector is
required. No factorization is involved, so can estimate the condition number of very
large and unstructured matrices.</p>
<dl class="docutils">
<dt>The algorithm used is the one described in:</dt>
<dd><ul class="first last">
<li><div class="first line-block">
<div class="line">H. Avron, A. Durinsky, and S. Toledo</div>
<div class="line"><a class="reference external" href="http://arxiv.org/pdf/1301.1107v3.pdf">Spectral Condition-Number Estimation of Large Sparse Matrices</a></div>
</div>
</li>
</ul>
</dd>
</dl>
<dl class="function">
<dt id="_CPP7CondEstRK10MatrixTypeRdRdR9RightTypeR8LeftTypeRdRdR9RightTypeR8LeftTypeRN4base9context_tE16condest_params_t">
int <code class="descclassname"></code><code class="descname">CondEst</code><span class="sig-paren">(</span><em class="property">const</em> MatrixType &amp;<em>A</em>, double &amp;<em>cond</em>, double &amp;<em>sigma_max</em>, RightType &amp;<em>v_max</em>, LeftType &amp;<em>u_max</em>, double &amp;<em>sigma_min</em>, double &amp;<em>sigma_min_c</em>, RightType &amp;<em>v_min</em>, LeftType &amp;<em>u_min</em>, base::context_t &amp;<em>context</em>, condest_params_t <em>params</em> = condest_params_t()<span class="sig-paren">)</span><a class="headerlink" href="#_CPP7CondEstRK10MatrixTypeRdRdR9RightTypeR8LeftTypeRdRdR9RightTypeR8LeftTypeRN4base9context_tE16condest_params_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the condition number of <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/>: estimate the largest and smallest
singular value. The estimate of the largest is highly accurate, and the
estimate of the lowest is typically a  not-too-bad upper bound. Returns also
certificate left and right vectors. For the
smallest singular vector, two estimates are returned: one with a certificate, and
one that is potentially (but not always) smaller but without certificate (it will
never be bigger than the estimate with certificate).</p>
</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="sketching.html">Sketching Layer</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="ml.html">Machine Learning</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright IBM Corporation 2012-2014.  All Rights Reserved.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>